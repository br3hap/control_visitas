<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- stock.picking inherit form view -->
    <record id="view_picking_delivery_trace_form" model="ir.ui.view">
        <field name="name">stock.picking.inherit.view.form</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_form"/>
        <field name="arch" type="xml">
            <!-- Add your xpath here -->
            <xpath expr="//field[@name='name']" position="after">
                <field name="b_allow_tracking" invisible='True'/>
            </xpath>
            <data>
                <xpath expr="//div[@name='button_box']/button[@name='open_website_url']" position="replace">
                    
                </xpath>
                <div name="button_box" position='inside'>
                    <!-- <button type="object" name="shipping_trace_button" class="oe_stat_button" icon='fa-truck' string="Tracking"
                        attrs="{'invisible': ['|',('carrier_tracking_ref','=',False),'|',('carrier_id', '=', False),'|',('delivery_type','=','grid'),('shipping_trace_count','=',0)]}" /> -->
                    <button type="object" name="shipping_trace_button" class="oe_stat_button" icon="fa-truck" 
                    attrs="{'invisible': ['|',('carrier_tracking_ref','=',False),'|',('delivery_type','=','grid'),('shipping_trace_count','=',0)]}">
                            <field name="shipping_trace_count" widget="statinfo" string="Seguimiento" />
                    </button>
                
                </div>

                <xpath expr="/form/header/button[last()]" position="after">
                    
                    <button name="generate_shipping_trace" string="Generar orden de transporte" type="object" attrs="{'invisible':['|',('state','!=','done'),
                    ('b_allow_tracking','=',False)]}" confirm='¿Esta seguro(a)
                    de generar un Seguimiento? si ya tiene una seguimiento se cancelará la anterior'/>
                </xpath>

                <xpath expr="//field[@name='carrier_tracking_ref']" position="attributes">
                    <attribute name="readonly" separator=" " add="1"></attribute>
                    
                </xpath>
                

                <xpath expr="//group[@name='other_infos']" position='after'>
                   <group string="Datos de Transporte" name="transport_data" attrs="{'invisible': [('b_allow_tracking','=',False)] }">
                        <field name="shipping_company_id" context="{'default_is_delivery_company': True}"/>
                        <field name="shipping_carrier_id"/>
                        <field name="scheduled_shipping_date"/>
                        <field name="vat_name"/>
                   </group>
                   <group string="Datos del Vehiculo" attrs="{'invisible': [('b_allow_tracking','=',False)] }">
                        <field name="vehicle_id"/>
                        <field name="vehicle_brand"/>
                   </group>
                    <field name="remark"/>
                </xpath>

                <!-- <xpath expr="//field[@name='carrier_id']" position="attributes">
                    <attribute name="string" add="Metodo de envio"></attribute>
                </xpath> -->
            </data>
            
        </field>
    </record>

</odoo>
