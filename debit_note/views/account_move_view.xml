<?xml version="1.0" encoding="UTF-8"?>
<odoo>
	<data>
        <record model="ir.ui.view" id="invoice_note_debit_form">
			<field name="name">invoice.note.debit.form</field>
			<field name="model">account.move</field>
			<field name="inherit_id" ref="fields_for_credit_note.view_move_form_inherit" />
			<field name="arch" type="xml">
                <xpath expr="//field[@name='related_document']" position="after">
                    <field name="is_note_document" invisible="1"></field>
                    <field name="invoice_id_not_required" invisible="1"></field>
                </xpath>
                <xpath expr="//field[@name='related_document']" position="attributes">
                    <attribute name="attrs">{'invisible': [('move_type','not in',('out_refund','in_refund')),('is_note_document','!=', True)],
                        'required': [('invoice_id_not_required','=',False),'|', ('move_type','in',('out_refund','in_refund')),('is_note_document','=', True)],
                        'readonly': [('state', '!=', 'draft')]}</attribute>                    
				</xpath>
                <xpath expr="//field[@name='reason']" position="attributes">
                    <attribute name="attrs">{'invisible': [('move_type','!=','out_refund'),('is_note_document','!=', True)],
                        'required': ['|', ('move_type','=','out_refund'),('is_note_document','=', True)],
                        'readonly': [('state', '!=', 'draft')]}</attribute>
				</xpath>
                <xpath expr="//field[@name='sustain']" position="attributes">
                    <attribute name="attrs">{'invisible': [('move_type','!=','out_refund'),('is_note_document','!=', True)],
                        'required': [ '|', ('move_type','=','out_refund'),('is_note_document','=', True)],
                        'readonly': [('state', '!=', 'draft')]}</attribute>
				</xpath>
                <xpath expr="//field[@name='date_related_document']" position="attributes">
                    <attribute name="attrs">{'invisible': [('move_type','!=','out_refund'),('is_note_document','!=', True)],
                        'required': [ '|', ('move_type','=','out_refund'),('is_note_document','=', True)],
                        'readonly': [('state', '!=', 'draft')]}</attribute>
				</xpath>
                <xpath expr="//field[@name='related_document_type']" position="replace">
                    <field name="related_document_type"
						attrs="{'invisible': [('move_type', 'in',('out_invoice','in_invoice')),('move_type','!=','out_refund'),('is_note_document','!=', True)], 
                                'required': [('invoice_id_not_required','=',False),'|', ('move_type', 'in',('out_refund','in_refund')),('is_note_document','=', True)], 
                                'readonly': [('state', '!=', 'draft')]}"
						options="{'no_open' : True, 'no_create_edit' : True, 'no_create' : True}" />
				</xpath>                
            </field>
        </record>
    </data>
</odoo>